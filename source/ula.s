	.extern chr_decode


	.text
	.global ula_render_line
    
ula_render_line:

	;@ r0 = address of ula memory
	;@ r1 = address of ds memory
	;@ r2 = raster line
	;@ r3 = flash

	;@ r4 = address of line in DS memory
	;@ r5 = address of gfx line in SPECTRUM memory
	;@ r6 = address of attr line in SPECTRUM memory

	stmdb sp!,{r4-r11,lr}  ;@ save registers on stack

	;@ flash bit
	mov r10, #0x400
	add r10, r10, r3, lsl #9

	mov r2, r2, lsl #1

	;@ calculate address of line in DS memory
	ldr r7, _table_lookup
	ldrh r8, [r7, r2]
	add r4, r1, r8

	;@ calculate address of gfx byte in SPECTRUM memory
	ldr r7, _table_lookup + 4
	ldrh r8, [r7, r2]
	add r5, r0, r8

	;@ calculate address of attr byte in SPECTRUM memory
	mov r7, r2, lsr #4
	add r6, r0, #0x1800
	add r6, r6, r7, lsl #5

	;@ address of gfx LUT
	ldr r7, _table_lookup + 12
	ldr r8, _table_lookup + 8
	add r9, r8, r10


	mov r2,#0xFF

	;@ Render raster line
	;@ Unrolled loop for speed purposes

	;@ spectrum gfx byte
	ldr r0, [r5], #4
	ands r10,r2,r0
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	ldr r1, [r6], #4
	and r11,r2,r1
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#8
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#8
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#16
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#16
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#24
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#24
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ldr r0, [r5], #4
	ands r10,r2,r0
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	ldr r1, [r6], #4
	and r11,r2,r1
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#8
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#8
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#16
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#16
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#24
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#24
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ldr r0, [r5], #4
	ands r10,r2,r0
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	ldr r1, [r6], #4
	and r11,r2,r1
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#8
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#8
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#16
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#16
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#24
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#24
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ldr r0, [r5], #4
	ands r10,r2,r0
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	ldr r1, [r6], #4
	and r11,r2,r1
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#8
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#8
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#16
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#16
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#24
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#24
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ldr r0, [r5], #4
	ands r10,r2,r0
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	ldr r1, [r6], #4
	and r11,r2,r1
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#8
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#8
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#16
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#16
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#24
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#24
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ldr r0, [r5], #4
	ands r10,r2,r0
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	ldr r1, [r6], #4
	and r11,r2,r1
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#8
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#8
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#16
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#16
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#24
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#24
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ldr r0, [r5], #4
	ands r10,r2,r0
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	ldr r1, [r6], #4
	and r11,r2,r1
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#8
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#8
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#16
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#16
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#24
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#24
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ldr r0, [r5], #4
	ands r10,r2,r0
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	ldr r1, [r6], #4
	and r11,r2,r1
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#8
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#8
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#16
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#16
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	;@ spectrum gfx byte
	ands r10,r2,r0,lsr#24
	ldrne r10, [r7, r10, lsl #2]

	;@	ink/paper
	and r11,r2,r1,lsr#24
	ldr r12, [r8, r11, lsl #2]
	and r10, r10, r12
	ldr r11, [r9, r11, lsl #2]
	eor r10, r10, r11
	str r10, [r4], #32

	ldmia sp!,{r4-r11,pc}  ;@ restore registers from stack and return to C code

	.align 4

_table_lookup:

	.word _ds_addr
	.word _ula_addr
	.word _attr_table
	.word chr_decode
	.align 4

_ds_addr:

	.hword 0x0000, 0x0004, 0x0008, 0x000C, 0x0010, 0x0014, 0x0018, 0x001C
	.hword 0x0400, 0x0404, 0x0408, 0x040C, 0x0410, 0x0414, 0x0418, 0x041C
	.hword 0x0800, 0x0804, 0x0808, 0x080C, 0x0810, 0x0814, 0x0818, 0x081C
	.hword 0x0C00, 0x0C04, 0x0C08, 0x0C0C, 0x0C10, 0x0C14, 0x0C18, 0x0C1C
	.hword 0x1000, 0x1004, 0x1008, 0x100C, 0x1010, 0x1014, 0x1018, 0x101C
	.hword 0x1400, 0x1404, 0x1408, 0x140C, 0x1410, 0x1414, 0x1418, 0x141C
	.hword 0x1800, 0x1804, 0x1808, 0x180C, 0x1810, 0x1814, 0x1818, 0x181C
	.hword 0x1C00, 0x1C04, 0x1C08, 0x1C0C, 0x1C10, 0x1C14, 0x1C18, 0x1C1C
	.hword 0x2000, 0x2004, 0x2008, 0x200C, 0x2010, 0x2014, 0x2018, 0x201C
	.hword 0x2400, 0x2404, 0x2408, 0x240C, 0x2410, 0x2414, 0x2418, 0x241C
	.hword 0x2800, 0x2804, 0x2808, 0x280C, 0x2810, 0x2814, 0x2818, 0x281C
	.hword 0x2C00, 0x2C04, 0x2C08, 0x2C0C, 0x2C10, 0x2C14, 0x2C18, 0x2C1C
	.hword 0x3000, 0x3004, 0x3008, 0x300C, 0x3010, 0x3014, 0x3018, 0x301C
	.hword 0x3400, 0x3404, 0x3408, 0x340C, 0x3410, 0x3414, 0x3418, 0x341C
	.hword 0x3800, 0x3804, 0x3808, 0x380C, 0x3810, 0x3814, 0x3818, 0x381C
	.hword 0x3C00, 0x3C04, 0x3C08, 0x3C0C, 0x3C10, 0x3C14, 0x3C18, 0x3C1C
	.hword 0x4000, 0x4004, 0x4008, 0x400C, 0x4010, 0x4014, 0x4018, 0x401C
	.hword 0x4400, 0x4404, 0x4408, 0x440C, 0x4410, 0x4414, 0x4418, 0x441C
	.hword 0x4800, 0x4804, 0x4808, 0x480C, 0x4810, 0x4814, 0x4818, 0x481C
	.hword 0x4C00, 0x4C04, 0x4C08, 0x4C0C, 0x4C10, 0x4C14, 0x4C18, 0x4C1C
	.hword 0x5000, 0x5004, 0x5008, 0x500C, 0x5010, 0x5014, 0x5018, 0x501C
	.hword 0x5400, 0x5404, 0x5408, 0x540C, 0x5410, 0x5414, 0x5418, 0x541C
	.hword 0x5800, 0x5804, 0x5808, 0x580C, 0x5810, 0x5814, 0x5818, 0x581C
	.hword 0x5C00, 0x5C04, 0x5C08, 0x5C0C, 0x5C10, 0x5C14, 0x5C18, 0x5C1C
	.align 4
	
_ula_addr:

	.hword 0x0000, 0x0100, 0x0200, 0x0300, 0x0400, 0x0500, 0x0600, 0x0700
	.hword 0x0020, 0x0120, 0x0220, 0x0320, 0x0420, 0x0520, 0x0620, 0x0720
	.hword 0x0040, 0x0140, 0x0240, 0x0340, 0x0440, 0x0540, 0x0640, 0x0740
	.hword 0x0060, 0x0160, 0x0260, 0x0360, 0x0460, 0x0560, 0x0660, 0x0760
	.hword 0x0080, 0x0180, 0x0280, 0x0380, 0x0480, 0x0580, 0x0680, 0x0780
	.hword 0x00A0, 0x01A0, 0x02A0, 0x03A0, 0x04A0, 0x05A0, 0x06A0, 0x07A0
	.hword 0x00C0, 0x01C0, 0x02C0, 0x03C0, 0x04C0, 0x05C0, 0x06C0, 0x07C0
	.hword 0x00E0, 0x01E0, 0x02E0, 0x03E0, 0x04E0, 0x05E0, 0x06E0, 0x07E0
	.hword 0x0800, 0x0900, 0x0A00, 0x0B00, 0x0C00, 0x0D00, 0x0E00, 0x0F00
	.hword 0x0820, 0x0920, 0x0A20, 0x0B20, 0x0C20, 0x0D20, 0x0E20, 0x0F20
	.hword 0x0840, 0x0940, 0x0A40, 0x0B40, 0x0C40, 0x0D40, 0x0E40, 0x0F40
	.hword 0x0860, 0x0960, 0x0A60, 0x0B60, 0x0C60, 0x0D60, 0x0E60, 0x0F60
	.hword 0x0880, 0x0980, 0x0A80, 0x0B80, 0x0C80, 0x0D80, 0x0E80, 0x0F80
	.hword 0x08A0, 0x09A0, 0x0AA0, 0x0BA0, 0x0CA0, 0x0DA0, 0x0EA0, 0x0FA0
	.hword 0x08C0, 0x09C0, 0x0AC0, 0x0BC0, 0x0CC0, 0x0DC0, 0x0EC0, 0x0FC0
	.hword 0x08E0, 0x09E0, 0x0AE0, 0x0BE0, 0x0CE0, 0x0DE0, 0x0EE0, 0x0FE0
	.hword 0x1000, 0x1100, 0x1200, 0x1300, 0x1400, 0x1500, 0x1600, 0x1700
	.hword 0x1020, 0x1120, 0x1220, 0x1320, 0x1420, 0x1520, 0x1620, 0x1720
	.hword 0x1040, 0x1140, 0x1240, 0x1340, 0x1440, 0x1540, 0x1640, 0x1740
	.hword 0x1060, 0x1160, 0x1260, 0x1360, 0x1460, 0x1560, 0x1660, 0x1760
	.hword 0x1080, 0x1180, 0x1280, 0x1380, 0x1480, 0x1580, 0x1680, 0x1780
	.hword 0x10A0, 0x11A0, 0x12A0, 0x13A0, 0x14A0, 0x15A0, 0x16A0, 0x17A0
	.hword 0x10C0, 0x11C0, 0x12C0, 0x13C0, 0x14C0, 0x15C0, 0x16C0, 0x17C0
	.hword 0x10E0, 0x11E0, 0x12E0, 0x13E0, 0x14E0, 0x15E0, 0x16E0, 0x17E0
	.align 4
	
_attr_table:

    .word 0x00000000, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
    .word 0x99999999, 0x00000000, 0x33333333, 0x22222222, 0x55555555, 0x44444444, 0x77777777, 0x66666666
    .word 0xAAAAAAAA, 0x33333333, 0x00000000, 0x11111111, 0x66666666, 0x77777777, 0x44444444, 0x55555555
    .word 0xBBBBBBBB, 0x22222222, 0x11111111, 0x00000000, 0x77777777, 0x66666666, 0x55555555, 0x44444444
    .word 0xCCCCCCCC, 0x55555555, 0x66666666, 0x77777777, 0x00000000, 0x11111111, 0x22222222, 0x33333333
    .word 0xDDDDDDDD, 0x44444444, 0x77777777, 0x66666666, 0x11111111, 0x00000000, 0x33333333, 0x22222222
    .word 0xEEEEEEEE, 0x77777777, 0x44444444, 0x55555555, 0x22222222, 0x33333333, 0x00000000, 0x11111111
    .word 0xFFFFFFFF, 0x66666666, 0x55555555, 0x44444444, 0x33333333, 0x22222222, 0x11111111, 0x00000000
    .word 0x00000000, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x11111111, 0x00000000, 0x33333333, 0x22222222, 0x55555555, 0x44444444, 0x77777777, 0x66666666
    .word 0x22222222, 0x33333333, 0x00000000, 0x11111111, 0x66666666, 0x77777777, 0x44444444, 0x55555555
    .word 0x33333333, 0x22222222, 0x11111111, 0x00000000, 0x77777777, 0x66666666, 0x55555555, 0x44444444
    .word 0x44444444, 0x55555555, 0x66666666, 0x77777777, 0x00000000, 0x11111111, 0x22222222, 0x33333333
    .word 0x55555555, 0x44444444, 0x77777777, 0x66666666, 0x11111111, 0x00000000, 0x33333333, 0x22222222
    .word 0x66666666, 0x77777777, 0x44444444, 0x55555555, 0x22222222, 0x33333333, 0x00000000, 0x11111111
    .word 0x77777777, 0x66666666, 0x55555555, 0x44444444, 0x33333333, 0x22222222, 0x11111111, 0x00000000
    .word 0x00000000, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
    .word 0x99999999, 0x00000000, 0x33333333, 0x22222222, 0x55555555, 0x44444444, 0x77777777, 0x66666666
    .word 0xAAAAAAAA, 0x33333333, 0x00000000, 0x11111111, 0x66666666, 0x77777777, 0x44444444, 0x55555555
    .word 0xBBBBBBBB, 0x22222222, 0x11111111, 0x00000000, 0x77777777, 0x66666666, 0x55555555, 0x44444444
    .word 0xCCCCCCCC, 0x55555555, 0x66666666, 0x77777777, 0x00000000, 0x11111111, 0x22222222, 0x33333333
    .word 0xDDDDDDDD, 0x44444444, 0x77777777, 0x66666666, 0x11111111, 0x00000000, 0x33333333, 0x22222222
    .word 0xEEEEEEEE, 0x77777777, 0x44444444, 0x55555555, 0x22222222, 0x33333333, 0x00000000, 0x11111111
    .word 0xFFFFFFFF, 0x66666666, 0x55555555, 0x44444444, 0x33333333, 0x22222222, 0x11111111, 0x00000000
    .word 0x00000000, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x11111111, 0x00000000, 0x33333333, 0x22222222, 0x55555555, 0x44444444, 0x77777777, 0x66666666
    .word 0x22222222, 0x33333333, 0x00000000, 0x11111111, 0x66666666, 0x77777777, 0x44444444, 0x55555555
    .word 0x33333333, 0x22222222, 0x11111111, 0x00000000, 0x77777777, 0x66666666, 0x55555555, 0x44444444
    .word 0x44444444, 0x55555555, 0x66666666, 0x77777777, 0x00000000, 0x11111111, 0x22222222, 0x33333333
    .word 0x55555555, 0x44444444, 0x77777777, 0x66666666, 0x11111111, 0x00000000, 0x33333333, 0x22222222
    .word 0x66666666, 0x77777777, 0x44444444, 0x55555555, 0x22222222, 0x33333333, 0x00000000, 0x11111111
    .word 0x77777777, 0x66666666, 0x55555555, 0x44444444, 0x33333333, 0x22222222, 0x11111111, 0x00000000
    .word 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888
    .word 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111
    .word 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222
    .word 0x33333333, 0x33333333, 0x33333333, 0x33333333, 0x33333333, 0x33333333, 0x33333333, 0x33333333
    .word 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444
    .word 0x55555555, 0x55555555, 0x55555555, 0x55555555, 0x55555555, 0x55555555, 0x55555555, 0x55555555
    .word 0x66666666, 0x66666666, 0x66666666, 0x66666666, 0x66666666, 0x66666666, 0x66666666, 0x66666666
    .word 0x77777777, 0x77777777, 0x77777777, 0x77777777, 0x77777777, 0x77777777, 0x77777777, 0x77777777
    .word 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888
    .word 0x99999999, 0x99999999, 0x99999999, 0x99999999, 0x99999999, 0x99999999, 0x99999999, 0x99999999
    .word 0xAAAAAAAA, 0xAAAAAAAA, 0xAAAAAAAA, 0xAAAAAAAA, 0xAAAAAAAA, 0xAAAAAAAA, 0xAAAAAAAA, 0xAAAAAAAA
    .word 0xBBBBBBBB, 0xBBBBBBBB, 0xBBBBBBBB, 0xBBBBBBBB, 0xBBBBBBBB, 0xBBBBBBBB, 0xBBBBBBBB, 0xBBBBBBBB
    .word 0xCCCCCCCC, 0xCCCCCCCC, 0xCCCCCCCC, 0xCCCCCCCC, 0xCCCCCCCC, 0xCCCCCCCC, 0xCCCCCCCC, 0xCCCCCCCC
    .word 0xDDDDDDDD, 0xDDDDDDDD, 0xDDDDDDDD, 0xDDDDDDDD, 0xDDDDDDDD, 0xDDDDDDDD, 0xDDDDDDDD, 0xDDDDDDDD
    .word 0xEEEEEEEE, 0xEEEEEEEE, 0xEEEEEEEE, 0xEEEEEEEE, 0xEEEEEEEE, 0xEEEEEEEE, 0xEEEEEEEE, 0xEEEEEEEE
    .word 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF
    .word 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888
    .word 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111
    .word 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222
    .word 0x33333333, 0x33333333, 0x33333333, 0x33333333, 0x33333333, 0x33333333, 0x33333333, 0x33333333
    .word 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444
    .word 0x55555555, 0x55555555, 0x55555555, 0x55555555, 0x55555555, 0x55555555, 0x55555555, 0x55555555
    .word 0x66666666, 0x66666666, 0x66666666, 0x66666666, 0x66666666, 0x66666666, 0x66666666, 0x66666666
    .word 0x77777777, 0x77777777, 0x77777777, 0x77777777, 0x77777777, 0x77777777, 0x77777777, 0x77777777
    .word 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888
    .word 0x99999999, 0x99999999, 0x99999999, 0x99999999, 0x99999999, 0x99999999, 0x99999999, 0x99999999
    .word 0xAAAAAAAA, 0xAAAAAAAA, 0xAAAAAAAA, 0xAAAAAAAA, 0xAAAAAAAA, 0xAAAAAAAA, 0xAAAAAAAA, 0xAAAAAAAA
    .word 0xBBBBBBBB, 0xBBBBBBBB, 0xBBBBBBBB, 0xBBBBBBBB, 0xBBBBBBBB, 0xBBBBBBBB, 0xBBBBBBBB, 0xBBBBBBBB
    .word 0xCCCCCCCC, 0xCCCCCCCC, 0xCCCCCCCC, 0xCCCCCCCC, 0xCCCCCCCC, 0xCCCCCCCC, 0xCCCCCCCC, 0xCCCCCCCC
    .word 0xDDDDDDDD, 0xDDDDDDDD, 0xDDDDDDDD, 0xDDDDDDDD, 0xDDDDDDDD, 0xDDDDDDDD, 0xDDDDDDDD, 0xDDDDDDDD
    .word 0xEEEEEEEE, 0xEEEEEEEE, 0xEEEEEEEE, 0xEEEEEEEE, 0xEEEEEEEE, 0xEEEEEEEE, 0xEEEEEEEE, 0xEEEEEEEE
    .word 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF
    .word 0x88888888, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x88888888, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x88888888, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x88888888, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x88888888, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x88888888, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x88888888, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x88888888, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x88888888, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
    .word 0x88888888, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
    .word 0x88888888, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
    .word 0x88888888, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
    .word 0x88888888, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
    .word 0x88888888, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
    .word 0x88888888, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
    .word 0x88888888, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
    .word 0x88888888, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x88888888, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x88888888, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x88888888, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x88888888, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x88888888, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x88888888, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x88888888, 0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x55555555, 0x66666666, 0x77777777
    .word 0x88888888, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
    .word 0x88888888, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
    .word 0x88888888, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
    .word 0x88888888, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
    .word 0x88888888, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
    .word 0x88888888, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
    .word 0x88888888, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
    .word 0x88888888, 0x99999999, 0xAAAAAAAA, 0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE, 0xFFFFFFFF
	.align 4
	
;_gfx_table:

;	.word 0x00000000, 0xF0000000, 0x0F000000, 0xFF000000, 0x00F00000, 0xF0F00000, 0x0FF00000, 0xFFF00000
;	.word 0x000F0000, 0xF00F0000, 0x0F0F0000, 0xFF0F0000, 0x00FF0000, 0xF0FF0000, 0x0FFF0000, 0xFFFF0000
;	.word 0x0000F000, 0xF000F000, 0x0F00F000, 0xFF00F000, 0x00F0F000, 0xF0F0F000, 0x0FF0F000, 0xFFF0F000
;	.word 0x000FF000, 0xF00FF000, 0x0F0FF000, 0xFF0FF000, 0x00FFF000, 0xF0FFF000, 0x0FFFF000, 0xFFFFF000
;	.word 0x00000F00, 0xF0000F00, 0x0F000F00, 0xFF000F00, 0x00F00F00, 0xF0F00F00, 0x0FF00F00, 0xFFF00F00
;	.word 0x000F0F00, 0xF00F0F00, 0x0F0F0F00, 0xFF0F0F00, 0x00FF0F00, 0xF0FF0F00, 0x0FFF0F00, 0xFFFF0F00
;	.word 0x0000FF00, 0xF000FF00, 0x0F00FF00, 0xFF00FF00, 0x00F0FF00, 0xF0F0FF00, 0x0FF0FF00, 0xFFF0FF00
;	.word 0x000FFF00, 0xF00FFF00, 0x0F0FFF00, 0xFF0FFF00, 0x00FFFF00, 0xF0FFFF00, 0x0FFFFF00, 0xFFFFFF00
;	.word 0x000000F0, 0xF00000F0, 0x0F0000F0, 0xFF0000F0, 0x00F000F0, 0xF0F000F0, 0x0FF000F0, 0xFFF000F0
;	.word 0x000F00F0, 0xF00F00F0, 0x0F0F00F0, 0xFF0F00F0, 0x00FF00F0, 0xF0FF00F0, 0x0FFF00F0, 0xFFFF00F0
;	.word 0x0000F0F0, 0xF000F0F0, 0x0F00F0F0, 0xFF00F0F0, 0x00F0F0F0, 0xF0F0F0F0, 0x0FF0F0F0, 0xFFF0F0F0
;	.word 0x000FF0F0, 0xF00FF0F0, 0x0F0FF0F0, 0xFF0FF0F0, 0x00FFF0F0, 0xF0FFF0F0, 0x0FFFF0F0, 0xFFFFF0F0
;	.word 0x00000FF0, 0xF0000FF0, 0x0F000FF0, 0xFF000FF0, 0x00F00FF0, 0xF0F00FF0, 0x0FF00FF0, 0xFFF00FF0
;	.word 0x000F0FF0, 0xF00F0FF0, 0x0F0F0FF0, 0xFF0F0FF0, 0x00FF0FF0, 0xF0FF0FF0, 0x0FFF0FF0, 0xFFFF0FF0
;	.word 0x0000FFF0, 0xF000FFF0, 0x0F00FFF0, 0xFF00FFF0, 0x00F0FFF0, 0xF0F0FFF0, 0x0FF0FFF0, 0xFFF0FFF0
;	.word 0x000FFFF0, 0xF00FFFF0, 0x0F0FFFF0, 0xFF0FFFF0, 0x00FFFFF0, 0xF0FFFFF0, 0x0FFFFFF0, 0xFFFFFFF0
;	.word 0x0000000F, 0xF000000F, 0x0F00000F, 0xFF00000F, 0x00F0000F, 0xF0F0000F, 0x0FF0000F, 0xFFF0000F
;	.word 0x000F000F, 0xF00F000F, 0x0F0F000F, 0xFF0F000F, 0x00FF000F, 0xF0FF000F, 0x0FFF000F, 0xFFFF000F
;	.word 0x0000F00F, 0xF000F00F, 0x0F00F00F, 0xFF00F00F, 0x00F0F00F, 0xF0F0F00F, 0x0FF0F00F, 0xFFF0F00F
;	.word 0x000FF00F, 0xF00FF00F, 0x0F0FF00F, 0xFF0FF00F, 0x00FFF00F, 0xF0FFF00F, 0x0FFFF00F, 0xFFFFF00F
;	.word 0x00000F0F, 0xF0000F0F, 0x0F000F0F, 0xFF000F0F, 0x00F00F0F, 0xF0F00F0F, 0x0FF00F0F, 0xFFF00F0F
;	.word 0x000F0F0F, 0xF00F0F0F, 0x0F0F0F0F, 0xFF0F0F0F, 0x00FF0F0F, 0xF0FF0F0F, 0x0FFF0F0F, 0xFFFF0F0F
;	.word 0x0000FF0F, 0xF000FF0F, 0x0F00FF0F, 0xFF00FF0F, 0x00F0FF0F, 0xF0F0FF0F, 0x0FF0FF0F, 0xFFF0FF0F
;	.word 0x000FFF0F, 0xF00FFF0F, 0x0F0FFF0F, 0xFF0FFF0F, 0x00FFFF0F, 0xF0FFFF0F, 0x0FFFFF0F, 0xFFFFFF0F
;	.word 0x000000FF, 0xF00000FF, 0x0F0000FF, 0xFF0000FF, 0x00F000FF, 0xF0F000FF, 0x0FF000FF, 0xFFF000FF
;	.word 0x000F00FF, 0xF00F00FF, 0x0F0F00FF, 0xFF0F00FF, 0x00FF00FF, 0xF0FF00FF, 0x0FFF00FF, 0xFFFF00FF
;	.word 0x0000F0FF, 0xF000F0FF, 0x0F00F0FF, 0xFF00F0FF, 0x00F0F0FF, 0xF0F0F0FF, 0x0FF0F0FF, 0xFFF0F0FF
;	.word 0x000FF0FF, 0xF00FF0FF, 0x0F0FF0FF, 0xFF0FF0FF, 0x00FFF0FF, 0xF0FFF0FF, 0x0FFFF0FF, 0xFFFFF0FF
;	.word 0x00000FFF, 0xF0000FFF, 0x0F000FFF, 0xFF000FFF, 0x00F00FFF, 0xF0F00FFF, 0x0FF00FFF, 0xFFF00FFF
;	.word 0x000F0FFF, 0xF00F0FFF, 0x0F0F0FFF, 0xFF0F0FFF, 0x00FF0FFF, 0xF0FF0FFF, 0x0FFF0FFF, 0xFFFF0FFF
;	.word 0x0000FFFF, 0xF000FFFF, 0x0F00FFFF, 0xFF00FFFF, 0x00F0FFFF, 0xF0F0FFFF, 0x0FF0FFFF, 0xFFF0FFFF
;	.word 0x000FFFFF, 0xF00FFFFF, 0x0F0FFFFF, 0xFF0FFFFF, 0x00FFFFFF, 0xF0FFFFFF, 0x0FFFFFFF, 0xFFFFFFFF

	.end